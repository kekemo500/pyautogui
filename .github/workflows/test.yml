name: Test OrganicHits on Ubuntu

on:
  workflow_dispatch:

jobs:
  test-organichits:
    runs-on: ubuntu-latest

    steps:
    - name: Update APT
      run: sudo apt-get update

    - name: Install dependencies
      run: sudo apt-get install -y wget dpkg

    - name: Download & Install OrganicHits
      run: |
        wget -qO organichits.deb https://cdn.organichits.co/download/organichits-exchanger_2.2.4_amd64.deb
        sudo dpkg -i organichits.deb || true
        sudo apt-get install -f -y     # Fix dependencies
        rm organichits.deb

    - name: Test commands
      run: |
        echo "===== Checking binary location ====="
        which organichits-exchanger || echo "Binary not found"

        echo "===== Try running --help ====="
        organichits-exchanger --help || echo "--help failed"

        echo "===== Try running without args ====="
        organichits-exchanger || echo "Run failed"

        echo "===== List installed files ====="
        dpkg -L organichits-exchanger || true
